CREATE OR ALTER FUNCTION dbo.GET_MAX_IDREPORT_REVENUE()
RETURNS INT
AS
BEGIN
	DECLARE 
		@MAX_ID_REPORT CHAR(10), 
		@MAX_NUM INT

	IF ((SELECT COUNT(*) FROM REVENUE) = 0)
		RETURN 0

	SELECT TOP 1 @MAX_ID_REPORT = ID_REVENUE_REPORT
	FROM REVENUE
	ORDER BY ID_REVENUE_REPORT DESC;
	
	DECLARE @SUB_MAX CHAR(10) = SUBSTRING(@MAX_ID_REPORT, 4, LEN(@MAX_ID_REPORT))
	SET @MAX_NUM = CAST(@SUB_MAX AS INT)

	RETURN @MAX_NUM
END
